var art_gallery=angular.module("art_gallery",["ngMaterial","ngAnimate","ngMessages","ngAria","ui.router"]);!function(t){t.config(["$stateProvider","$urlRouterProvider","$mdIconProvider",function(e,r,o){"undefined"!=typeof web3?t.web3Provider=web3.currentProvider:t.web3Provider=new Web3.providers.HttpProvider("http://127.0.0.1:7545"),r.otherwise("/"),o.iconSet("action","public/images/action-icons.svg",24).iconSet("content","public/images/content-icons.svg",24),e.state("updateart",{url:"/updateArt",templateUrl:"partials/updateart-partial.html",controller:"updateartController"}).state("home",{url:"/",templateUrl:"partials/home-partial.html",controller:"HomeController"}).state("about",{url:"/about",templateUrl:"partials/about-partial.html",controller:"AboutController"})}])}(art_gallery),function(t){t.service("storeService",["$http",function(t){var e={};return e.query=function(e){t({method:"GET",url:"/api/stores"}).then(function(t){e(t.data,null)},function(t){e(null,t)})},e.create=function(e,r){t({method:"POST",url:"/api/stores",data:e}).then(function(t){r(t.data,null)},function(t){r(null,t)})},e.purchase=function(e,r,o){t({method:"PUT",url:"/api/stores/purchase/"+e,data:r}).then(function(t){o(t.data,null)},function(t){o(null,t)})},e}])}(art_gallery),function(t){t.controller("AboutController",["$scope",function(t){}])}(art_gallery),function(t){t.controller("HomeController",["$scope","storeService","$mdDialog",function(t,e,r){t.arts=[],e.query(function(e,r){t.arts=e,console.log(t.arts)}),t.openConfirmPurchase=function(o,a){a.preventDefault();r.show({templateUrl:"/partials/shop-modal-partial.html",controller:"shopModalController",parent:angular.element(document.body),resolve:{art:function(){return o}}}).then(function(r){e.query(function(e,r){t.arts=e})},function(){})}}])}(art_gallery),function(t){t.controller("shopModalController",["$scope","storeService","$mdDialog","$mdToast","art",function(e,r,o,a,n){e.art=n,web3=new Web3(t.web3Provider),e.price=(web3.fromWei(n.price,"ether")/.001634).toFixed(2),console.log(e.price),e.cancel=function(){o.cancel()},e.save=function(){r.purchase(e.art.id,{price:e.art.price},function(t,e){e?a.show({template:'<md-toast class="md-toast error" >Error purchasing the art</md-toast>',hideDelay:6e3,position:"top right"}):(a.show({template:'<md-toast class="md-toast success" >Purchase succesfull</md-toast>',hideDelay:6e3,position:"top right"}),o.hide())})}}])}(art_gallery),function(t){t.controller("updateartController",["$scope","storeService","$mdToast","$timeout",function(e,r,o,a){e.art={},web3=new Web3(t.web3Provider),e.updateArt=function(){e.art.price=.001634*e.art.price,r.create(e.art,function(t,r){r?o.show({template:'<md-toast class="md-toast error" >Error saving the art</md-toast>',hideDelay:6e3,position:"top right"}):(o.show({template:'<md-toast class="md-toast success" >New art work saved succesfull</md-toast>',hideDelay:6e3,position:"top right"}),a(function(){e.art={},e.artForm.$setPristine(),e.artForm.$setUntouched(),e.artForm.$submitted=!1}))})}}]),t.directive("addressInvalid",function(){return{restrict:"A",require:"ngModel",link:function(t,e,r,o){o.$validators.addressInvalid=function(t){return web3.isAddress(t)}}}})}(art_gallery);